# Coluna cxfuseq da tabela dbcaixa passa a ser obrigatorio
# Coluna notnull|obrigatorio da tabela campos se torna required
# Verificar se todas as tabelas tem o statseq como valor padrÃ£o 1
# Adicionar na view_inscricao as colunas vencimentomatricula, vencimentotaxa
# Adicionar a coluna formapag na view_caixa (dbforma_pagamento -> titulo)

# VIEW DE PESSOAS
	CREATE OR REPLACE VIEW view_pessoa AS 
	 SELECT 
	t1.seq, 
	t1.unidseq, 
	t1.usuaseq, 
	t1.tipo, 
	t1.pessnmrz, 
	t1.pessnmrf, 
	t1.pessrgie, 
	t1.pessteim, 
	t1.cliente, 
	t1.fornecedor, 
	t1.funcionario, 
	to_char(t1.datacad::timestamp with time zone, 'DD/MM/YYYY'::text) AS datacad, 
	t999.seq AS statseq, 
	t999.statdesc,
	t2.telefone AS telefone1,
	t3.telefone AS telefone2,
	t4.email AS email
	
	   FROM dbpessoa t1
	   LEFT JOIN dbtelefone t2 ON t2.pessseq = t1.seq AND t2.tpteseq = 1
	   LEFT JOIN dbtelefone t3 ON t3.pessseq = t1.seq AND t3.tpteseq = 2 
	   LEFT JOIN dbemail t4 ON t4.pessseq = t1.seq AND t4.titulo = 'E-mail Principal' 
	   LEFT JOIN dbstatus t999 ON t999.seq = t1.statseq;
	
	ALTER TABLE view_pessoa
	  OWNER TO postgres;

